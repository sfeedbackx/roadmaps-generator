datasource db {
  // could be postgresql or mysql
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator db {
  provider             = "prisma-client-py"
  interface            = "asyncio"
  recursive_type_depth = 5
}

model Skill {
  id                  String                 @id @default(cuid())
  topic               Topic                  @relation(fields: [topic_id], references: [id])
  topic_id            String
  title               String
  description         String
  duration            Int
  score               Int
  study_hours_per_day Int
  skill_type          SkillTypeEnum          @default(REQUIRED)
  technologie         String
  free_resources      Json?
  paid_resources      Json?
  
  prerequisites       PrerequisiteForSkill[] @relation("SkillPrerequisites")
  requiredBy          PrerequisiteForSkill[] @relation("PrerequisiteSkill")
  
  created_at          DateTime               @default(now())
  updated_at          DateTime               @updatedAt
}

model PrerequisiteForSkill {
  skill               Skill         @relation("SkillPrerequisites", fields: [skill_id], references: [id])
  skill_id            String
  prerequisite        Skill         @relation("PrerequisiteSkill", fields: [prerequisite_id], references: [id])
  prerequisite_id     String
  importance          SkillTypeEnum @default(REQUIRED)
  assignedAt          DateTime      @default(now())
  
  @@id([skill_id, prerequisite_id])
}

enum SkillTypeEnum {
  REQUIRED 
  RECOMMENDED
  OPTIONAL
}

model Topic {
  id              String   @id @default(cuid())
  title           String
  depth           Int
  parent_topic    Topic?   @relation("TopicHierarchy", fields: [parent_topic_id], references: [id])
  parent_topic_id String?
  child_topics    Topic[]  @relation("TopicHierarchy")
  skills          Skill[]
  
  created_at      DateTime @default(now())
  updated_at      DateTime @updatedAt
}
